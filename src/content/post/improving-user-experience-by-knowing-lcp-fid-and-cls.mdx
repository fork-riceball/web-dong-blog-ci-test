---
isDraft: false
featureIcon: { url: 'images/posts/feature-icon/metric.svg', alt: '統計符號' }
title: 'Improving user experience by knowing LCP, FID and CLS'
titleTC: '學習衡量網頁效能的三大核心指標：LCP、FID、CLS'
excerpt: '製作會動的網站是一件事，製作能用的網站又是另一件事。網頁體驗一直是一個比較虛幻難量化的事情。本文將介紹 Google 提出的三大體驗指標測驗並提升網站使用體驗。'
category: '教學'
tags: ['網頁效能']
publishDate: '2023-05-10'
---

## 前言

> 製作出會動的網站是一件事，製作能用的網站又是另一件事

如果使用 Google 提供的網站檢測工具，像是[PageSpeed](https://pagespeed.web.dev/)，會看到相關的專業詞彙像是： <abbr title="Largest Contentful Paint">LCP</abbr> 
、 <abbr title="First Input Delay">FID</abbr> 或 <abbr title="Cumulative Layout Shift">CLS</abbr> ，它們被統稱為核心網頁指標 (Core Web Vitals)，分別從**效能、交互性與視覺穩定為衡量基準**，來測量該網頁的瀏覽體驗。

現在就可以開始對網站使用 [PageSpeed Insights](https://pagespeed.web.dev/) 實行檢測，並且藉由本篇文章了解如何解讀報告中的指標並開始改善網站用戶體驗～

## 網頁核心指標
### <abbr title="Largest Contentful Paint">LCP</abbr> - 最大內容繪製（效能）

<Figure width="700" height="230" src="images/posts/improving-user-experience-by-knowing-lcp-fid-and-cls/lcp.svg" alt="LCP 指標範圍說明" />

> 測量網頁中最大圖片或文字渲染出來的時間

要測量網頁的效能會通常會輔以以下各式各樣的方式於衡量網頁內容顯示的最快時間，像是：
* <abbr title="First Contentful Paint">FCP</abbr> [首次內容繪製](https://web.dev/i18n/zh/fcp/)
* <abbr title="First Meaningful Paint">FMP</abbr> [首次有效繪製](https://developer.chrome.com/docs/lighthouse/performance/first-meaningful-paint/)
* <abbr title="Speed Index">SI</abbr> [速度指標](https://developer.chrome.com/docs/lighthouse/performance/speed-index/)

它們都是不錯的方法測量方式，各自反映了網頁加載時可留意的重點，那麼既然前面已經有三種測量的指標方式，為什麼還會需要用 LCP 來檢測網頁呢？先來了解其他方法，才能知道使用 LCP 有什麼好處。

* **FCP 首次內容繪製**：網頁載入過程中「首個」內容元素的出現時間，例如文字、圖像或背景顏色。然而僅考慮第一個元素的載入時間可能無法實體現真實的用戶體驗。因此當網頁有大型圖像或延遲載入的內容時，則無法提供完整的性能評估。

* **FMP 首次有效繪製**：網頁載入過程中「首個有意義」內容(用戶視覺上可見、與網頁目的相關、能夠傳遞信息並具有交互性的內容)的出現時間。它考慮了比 FCP 更有價值的內容元素，但仍然可能無法捕捉到整體網頁載入過程中可能存在最大的性能問題。

* **SI 速度指標**：網頁載入過程中加載速度的指標，它考慮了整個載入過程中的視覺變化情況。根據整個網頁的渲染時間和視覺變化的頻率計算出一個數值。然而它並沒有明確反映用戶關注的內容。

因此出現「LCP - 最大內容繪製」，同樣也是為了達成「量化用戶加載網頁時長體驗」，它能更全面的代表用戶使用網站的體驗。藉由綜合以上指標給予的提示，可以得出明確的方向去改善網站的使用體驗。

#### 怎麼樣才算好的 LCP 分數？

根據 Google 的要求，一個網站應盡量在 **2.5 秒** 內完成最大內容的繪製。

#### 如何改善 LCP 指標？

通常只要盡量保持網站整體加載的速度流暢就可以解決該問題，因此以下是一些方向去改善該指標：

* 避免阻礙渲染的資源
* 最小化 CSS
* 去除未用的 CSS
* 去除未用的 JavaScript
* 預先連接需要的來源
* 減少伺服器反應時間
* 避免多重頁面跳轉
* 預加載關鍵請求
* 避免巨大的網路負載
* 使用高效的緩存策略服務靜態資產
* 避免 DOM 過大
* 最小化關鍵請求深度
* 確保文本在網頁字體加載期間保持可見
* 保持較低的請求數和較小的傳輸檔案

### <abbr title="First Input Delay">FID</abbr> - 首次輸入延遲（互動性）

<Figure width="700" height="230" src="images/posts/improving-user-experience-by-knowing-lcp-fid-and-cls/fid.svg" alt="FID 指標範圍說明" />

> 測量從使用者第一次與你的網站互動（點選連結、按鈕或是使用自訂的 JavaScript 控制），瀏覽器實際上能夠回應該互動的時間點

由於 [JavaScript 在網頁中是單線程的](/post/async-javascript-visualized-with-ease)，意味著如果該頁面在忙碌於處理其他工作時，就有可能會導致瀏覽器回應用戶的互動被暫時擱置，這樣的問題應當被測量且盡可能的避免，這就是首次輸入延遲指標。

#### 怎麼樣才算好的 FID 分數

根據 Google 的要求，一個網站應盡量在 **100 毫秒** 內能夠回應用戶的動作。

#### 如何改善 FID 指標？

盡可能的解放瀏覽器主執行序面臨的工作，藉由減少其工作量或轉移到 [Web Worker](https://developer.mozilla.org/zh-TW/docs/Web/API/Web_Workers_API/Using_web_workers) 都是可行的方案：

* 減少第三方代碼的影響
* 減少 JavaScript 的執行時間
* 最小化主線程工作
* 保持較低的請求數和較小的傳輸大小



### <abbr title="Cumulative Layout Shift">CLS</abbr> - 累積布局偏移（視覺穩定）

<Figure width="700" height="230" src="images/posts/improving-user-experience-by-knowing-lcp-fid-and-cls/cls.svg" alt="CLS 指標範圍說明" />

> 測量網頁呈現內容的穩定性

通過追蹤網頁上的元素，並測量它們在載入過程中的位置變化來進行的。當使用者正在與網頁互動時，突然出現元素的位置改變會導致使用者的焦點偏移，對體驗產生負面影響。

#### 怎麼樣才算好的 CLS 分數？
根據 Google 的要求，一個網站應盡量在 **0.1** CLS 以內。

#### 如何改善 CLS 分數？

可能保持網站內容的位置與大小，不隨意的改動畫面，常見可以改善的方向如下：

* 標示清楚圖片的尺寸
* 為動態加載的內容(廣告、iframe、embeds)保留空間，或避免加入在網頁上方
* 動畫
* 網頁字體

## 測量基準

以上三種網頁指標基準都是根據 Google 統整並定義出來的，其中行動裝置與電腦也會根據性能上的差異有不一樣的要求，詳細可以參考看看：[定義核心 Web 指標閥值](https://web.dev/i18n/zh/defining-core-web-vitals-thresholds/)。

此外須留意 Google 的搜尋引擎會根據網站的所有頁面統整做個綜合評分，如果 75% 的頁面達成「優良」評分，那麼該網站在該指標下就會被評為「優良」，因此監控整體網站內所有頁面的評分是重要的。

## 參考資料
* [優化 Largest Contentful Paint 最大內容繪製](https://web.dev/i18n/zh/optimize-lcp/)


<Info type="info">本文中的部分內容是根據 Google 所建立並分享的內容所進行的修改，並遵循 [創用 CC 4.0 姓名標示授權條款](https://creativecommons.org/licenses/by/4.0/) 中所述的條款使用。 </Info>